name: Update Existing Control
description: Propose updates to an existing security control in the CoSAI Risk Map
title: "[Update Control]: "
labels: ["control", "update-control"]
body:
  - type: markdown
    attributes:
      value: |
        ## Update an Existing Control

        Use this template to propose changes to an existing control. Only fill out the sections relevant to your proposed changes.

  - type: input
    id: control-permalink
    attributes:
      label: Control Permalink*
      description: |
        GitHub permalink to the control in controls.yaml (right-click line number â†’ Copy permalink)

        ðŸ“‹ [Browse controls.yaml](../../risk-map/yaml/controls.yaml)
      placeholder: "https://github.com/org/repo/blob/abc123/risk-map/yaml/controls.yaml#L45-L52"
    validations:
      required: true

  - type: dropdown
    id: change-type
    attributes:
      label: Change Type*
      description: What type of change are you proposing?
      options:
        - Update description/title (clarification or correction)
        - Add mappings (components, risks, frameworks)
        - Remove mappings (components, risks, frameworks)
        - Change category or personas
        - Add metadata (lifecycle, impact type, actor access)
        - Other (describe below)
    validations:
      required: true

  - type: textarea
    id: proposed-changes
    attributes:
      label: Proposed Changes*
      description: |
        Describe what you want to change and why. Be specific about what should be added, removed, or modified.

        **Examples:**
        - "Update description to clarify that this control also applies to fine-tuning scenarios"
        - "Add componentModelEvaluation to components list - this control is relevant during evaluation phase"
        - "Remove PIJ from risks - this control doesn't effectively mitigate prompt injection"
        - "Add MITRE ATLAS mapping AML.M0015 (Adversarial Input Detection)"
      placeholder: |
        Current state: [what it says now]
        Proposed change: [what it should say]
        Rationale: [why this change improves the control]
    validations:
      required: true

  - type: markdown
    attributes:
      value: |
        ---
        ## Quick Add/Remove (Optional)

        Use these fields for quick additions or removals. Leave blank if not applicable.

  - type: textarea
    id: add-components
    attributes:
      label: Add Components
      description: |
        Component IDs to add (one per line)

        ðŸ“‹ [View component list](../../risk-map/tables/components-summary.md)
      placeholder: |
        componentModelEvaluation
        componentOutputHandling

  - type: textarea
    id: remove-components
    attributes:
      label: Remove Components
      description: Component IDs to remove (one per line)
      placeholder: |
        componentDataSources

  - type: textarea
    id: add-risks
    attributes:
      label: Add Risks
      description: |
        Risk IDs to add (one per line)

        ðŸ“‹ [View risk list](../../risk-map/tables/risks-summary.md)
      placeholder: |
        MEV
        IIC

  - type: textarea
    id: remove-risks
    attributes:
      label: Remove Risks
      description: Risk IDs to remove (one per line)
      placeholder: |
        PIJ

  - type: textarea
    id: add-framework-mappings
    attributes:
      label: Add Framework Mappings
      description: |
        Framework mappings to add. Use format: `framework-id: mapping-value`

        Valid frameworks for controls: mitre-atlas, nist-ai-rmf
      placeholder: |
        mitre-atlas: AML.M0015
        nist-ai-rmf: GV-4.1

  - type: textarea
    id: supporting-evidence
    attributes:
      label: Supporting Evidence
      description: |
        Links to discussions, references, standards, or other evidence supporting this change
      placeholder: |
        - NIST AI RMF section 3.2.1 describes this mitigation approach
        - Discussion in issue #123
        - Reference implementation: https://example.com/control-impl

  - type: checkboxes
    id: terms
    attributes:
      label: Submission Checklist
      description: Please confirm the following
      options:
        - label: I have provided a valid GitHub permalink to the control
          required: true
        - label: I have clearly described the proposed changes and rationale
          required: true
        - label: This change improves the accuracy or completeness of the control
          required: true
